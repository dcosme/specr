<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Customizing plots • specr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Customizing plots">
<meta property="og:description" content="specr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">specr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/specr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/custom-plot.html">Customizing plots</a>
    </li>
    <li>
      <a href="../articles/decompose_var.html">Identifying variance components</a>
    </li>
    <li>
      <a href="../articles/invest-spec.html">Investigating specific specifications</a>
    </li>
    <li>
      <a href="../articles/measurement_models.html">Including latent measurement models</a>
    </li>
    <li>
      <a href="../articles/progress.html">Visualizing progress</a>
    </li>
    <li>
      <a href="../articles/random_effects.html">Including random effects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/masurp/specr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="custom-plot_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Customizing plots</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/masurp/specr/blob/master/vignettes/custom-plot.rmd"><code>vignettes/custom-plot.rmd</code></a></small>
      <div class="hidden name"><code>custom-plot.rmd</code></div>

    </div>

    
    
<p>This vignette exemplifies different ways to plot the specification curve. For most cases, the function <code><a href="../reference/plot_specs.html">plot_specs()</a></code> takes care of the overall process. However, more specific customization is possible if we use the more specific functions <code><a href="../reference/plot_curve.html">plot_curve()</a></code> and <code>plot_choices</code>. Furthermore, we can extend the overall plot with the additional function <code><a href="../reference/plot_samplesizes.html">plot_samplesizes()</a></code>. All of these functions produce objects of the class <a href="https://ggplot2.tidyverse.org/index.html">ggplot</a> that can be customized further using the grammar of graphics provided by the package <a href="https://ggplot2.tidyverse.org/index.html">ggplot2</a>.</p>
<div id="run-the-specification-curve-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#run-the-specification-curve-analysis" class="anchor"></a>1. Run the specification curve analysis</h2>
<p>In order to have some data to work with, we run the minimal example included in the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://masurp.github.io/specr/">specr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/">cowplot</a></span><span class="op">)</span>

<span class="co"># run spec analysis</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_specs.html">run_specs</a></span><span class="op">(</span><span class="va">example_data</span>,
                     y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y1"</span>, <span class="st">"y2"</span><span class="op">)</span>,
                     x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span>,
                     model <span class="op">=</span> <span class="st">"lm"</span>,
                     controls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c1"</span>, <span class="st">"c2"</span><span class="op">)</span>,
                     subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>group1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">group1</span><span class="op">)</span>,
                                   group2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">group2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>Let’s quickly get some ideas about the specification curve by using <code><a href="../reference/summarise_specs.html">summarise_specs()</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="../reference/summarise_specs.html">summarise_specs</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></pre></div>
<pre><code>## # A tibble: 1 x 7
##   median   mad   min   max   q25   q75   obs
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   3.59  4.56 -2.05  9.58  1.03  7.63   123</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="../reference/summarise_specs.html">summarise_specs</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">x</span><span class="op">)</span></pre></div>
<pre><code>## # A tibble: 2 x 8
##   x     median   mad    min   max   q25   q75   obs
##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 x1      3.59  4.42 -2.05   9.28 0.510  6.51   123
## 2 x2      4.40  4.84 -0.258  9.58 1.31   7.79   123</code></pre>
<p>We see that it makes quite a difference whether <code>x1</code> or <code>x2</code> is used as independent variable.</p>
</div>
<div id="a-simple-way-to-visualize-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#a-simple-way-to-visualize-the-results" class="anchor"></a>2. A simple way to visualize the results</h2>
<p>The simplest way to visualize most of the information contained in the results data frame is by using the <code><a href="../reference/plot_specs.html">plot_specs()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="../reference/plot_specs.html">plot_specs</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></pre></div>
<p><img src="custom-plot_files/figure-html/unnamed-chunk-3-1.png" width="960"></p>
<p>We can further customize that function, e.g., by removing unnecessary information (in this case we only specified one model, this analytical choice is hence useless) or by reordering/transforming the analytical choices (and thereby visualize specific contrasts).</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="../reference/plot_specs.html">plot_specs</a></span><span class="op">(</span><span class="va">results</span>, 
           choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"controls"</span>, <span class="st">"subsets"</span><span class="op">)</span>,  <span class="co"># "model is not plotted</span>
           rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>                         <span class="co"># changing relative heights</span></pre></div>
<p><img src="custom-plot_files/figure-html/unnamed-chunk-4-1.png" width="960"></p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="co"># Investigating specific contrasts</span>
<span class="va">results</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>group1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"group1 = 0"</span>, <span class="va">subsets</span><span class="op">)</span>, <span class="st">"0"</span>, <span class="st">"1"</span><span class="op">)</span>,
         group2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"group2 = A"</span>, <span class="va">subsets</span><span class="op">)</span>, <span class="st">"A"</span>, <span class="st">"B &amp; C"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/plot_specs.html">plot_specs</a></span><span class="op">(</span>choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"controls"</span>, <span class="st">"group1"</span>, <span class="st">"group2"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="custom-plot_files/figure-html/unnamed-chunk-4-2.png" width="960"></p>
</div>
<div id="an-alternative-way-to-visualize-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#an-alternative-way-to-visualize-the-results" class="anchor"></a>3. An alternative way to visualize the results</h2>
<div id="plot-curve-and-choices-seperately" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-curve-and-choices-seperately" class="anchor"></a>3.1. Plot curve and choices seperately</h3>
<p>The overall function <code><a href="../reference/plot_specs.html">plot_specs()</a></code> is not very flexible. Alternatively, we can plot the specification curve and the choice panel individually and bind them together afterwards. This is useful as it allows us to customize and change both individual plots.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="co"># Plot specification curve</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_curve.html">plot_curve</a></span><span class="op">(</span><span class="va">results</span>, 
                 ci <span class="op">=</span> <span class="cn">FALSE</span>, 
                 ribbon <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, 
             linetype <span class="op">=</span> <span class="st">"dashed"</span>, 
             color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>, <span class="fl">14</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"unstandarized regression coefficient"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_half_open</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Plot choices</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_choices.html">plot_choices</a></span><span class="op">(</span><span class="va">results</span>, 
                   choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"controls"</span>, <span class="st">"subsets"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"specifications (ranked)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_half_open</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Combine plots</span>
<span class="fu"><a href="../reference/plot_specs.html">plot_specs</a></span><span class="op">(</span>plot_a <span class="op">=</span> <span class="va">p1</span>,
           plot_b <span class="op">=</span> <span class="va">p2</span>,
           labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span><span class="op">)</span>,      <span class="co"># remove plot labels</span>
           rel_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># adjust relative heights</span></pre></div>
<p><img src="custom-plot_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
</div>
<div id="include-sample-size-histogram" class="section level3">
<h3 class="hasAnchor">
<a href="#include-sample-size-histogram" class="anchor"></a>3.2. Include sample size histogram</h3>
<p>By default, we do not know how many participants were included in each specification. If you remove missing values listwise, this may not be a big problem as all models are based on the same subsample. If you have missing values in your dataset and you did not impute them or delete them listwise, we should investigate how many participants were included in each specification. The function <code><a href="../reference/plot_samplesizes.html">plot_samplesizes()</a></code> provides an additional panel that can then be added to the overall plot using <code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">cowplot::plot_grid()</a></code></p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_samplesizes.html">plot_samplesizes</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://wilkelab.org/cowplot/reference/theme_cowplot.html">theme_half_open</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Combine via cowplot</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>,
          ncol <span class="op">=</span> <span class="fl">1</span>,
          align <span class="op">=</span> <span class="st">"v"</span>,
          rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">0.8</span><span class="op">)</span>,
          axis <span class="op">=</span> <span class="st">"rbl"</span><span class="op">)</span></pre></div>
<p><img src="custom-plot_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Philipp K. Masur, Michael Scharkow.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
